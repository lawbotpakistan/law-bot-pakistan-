"use strict";(()=>{var e={};e.id=548,e.ids=[548,888,660],e.modules={320:(e,t,r)=>{r.r(t),r.d(t,{config:()=>j,default:()=>f,getServerSideProps:()=>h,getStaticPaths:()=>v,getStaticProps:()=>b,reportWebVitals:()=>x,routeModule:()=>y,unstable_getServerProps:()=>k,unstable_getServerSideProps:()=>q,unstable_getStaticParams:()=>w,unstable_getStaticPaths:()=>A,unstable_getStaticProps:()=>E});var s={};r.r(s),r.d(s,{config:()=>c,default:()=>handler});var a=r(93),n=r(244),i=r(323),o=r(209),l=r.n(o),u=r(337),d=r.n(u),p=r(885);let c={runtime:"nodejs"},_=process.env.SUPABASE_URL,S=process.env.SUPABASE_ANON_KEY,g=process.env.SUPABASE_SERVICE_ROLE_KEY,m=(0,p.createClient)(_,S),P=(0,p.createClient)(_,g);async function handler(e,t){if("GET"!==e.method)return t.status(405).json({error:"Method not allowed"});try{let r=e.headers.authorization||"",s=r.split(" ")[1];if(!s)return t.status(401).json({error:"Missing token"});let{data:a,error:n}=await m.auth.getUser(s);if(n||!a?.user)return t.status(401).json({error:"Invalid token"});let i=a.user,{data:o,error:l}=await P.from("profiles").select("is_admin").eq("id",i.id).single();if(l)return t.status(500).json({error:"Failed to load profile"});if(!o?.is_admin)return t.status(403).json({error:"Not admin"});let{data:u,error:d}=await P.from("payments").select("id,user_id,payer_name,payer_ref,file_url,amount,status,created_at").order("created_at",{ascending:!1});if(d)return t.status(500).json({error:d.message});return t.status(200).json({data:u})}catch(e){return console.error("admin/list error:",e),t.status(500).json({error:"Internal server error"})}}let f=(0,i.l)(s,"default"),b=(0,i.l)(s,"getStaticProps"),v=(0,i.l)(s,"getStaticPaths"),h=(0,i.l)(s,"getServerSideProps"),j=(0,i.l)(s,"config"),x=(0,i.l)(s,"reportWebVitals"),E=(0,i.l)(s,"unstable_getStaticProps"),A=(0,i.l)(s,"unstable_getStaticPaths"),w=(0,i.l)(s,"unstable_getStaticParams"),k=(0,i.l)(s,"unstable_getServerProps"),q=(0,i.l)(s,"unstable_getServerSideProps"),y=new a.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/admin/list",pathname:"/admin/list",bundlePath:"",filename:""},components:{App:d(),Document:l()},userland:s})},885:e=>{e.exports=require("@supabase/supabase-js")},785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},689:e=>{e.exports=require("react")},17:e=>{e.exports=require("path")}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[514,209,337,450],()=>__webpack_exec__(320));module.exports=r})();